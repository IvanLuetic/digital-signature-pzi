import{r,c as n,j as C,g as V,h as c,a as e,_ as z,k as F,i as m,n as I,t as v,f as p,F as E,o as a}from"./index-_KYfJ8Fu.js";import{v as S}from"./document-DAwv_s8A.js";const N={class:"flex flex-col items-center gap-8 mx-4 pb-30"},j={class:"w-full md:w-3/5 lg:w-2/5 flex justify-center items-center"},B={key:0,class:"flex justify-center items-center z-50 absolute inset-0 bg-white/80 backdrop-blur-sm rounded-2xl"},L={key:1,class:"mdi mdi-folder-zip text-7xl text-blue-600"},P={key:2,class:"text-xl text-gray-600 text-center font-medium"},A={class:"z-50"},T={class:"relative bottom-6 text-center"},Z={key:0},$={class:"flex items-center justify-center"},R=["disabled"],U={key:0,class:"w-full md:w-3/5 lg:w-2/5 mt-8"},G={class:"p-6 rounded-xl border-2' 'border-green-500 bg-green-100"},M={class:"text-left space-y-2"},J={__name:"VerifyDocument",setup(O){const o=r(""),i=r(""),f=r(!1),l=r(null),u=r(!1),x=r(null),d=r(null),g=r(null),y=r(null),b=async s=>{f.value=!0;const t=s.dataTransfer?.files[0]||s.target.files[0];l.value=t,l.value.name.toLowerCase().endsWith("zip")?f.value=!1:(l.value="",alert("Please upload a .zip file"))},h=()=>{g.value.click()},w=async()=>{if(!l.value){o.value="Please select a ZIP file to verify";return}u.value=!0,d.value=null,o.value="",i.value="";try{const s=new FormData;s.append("file",l.value);const t=await S(s);d.value=t.data,i.value=t.data.message}catch(s){s.response?.status===404?o.value=s.response.data.message||"No matching signature found":o.value=s.response?.data?.message||"Error verifying document signature"}finally{u.value=!1}},_=()=>{l.value=null,x.value=null,d.value=null,u.value=!1,g.value.value=null,o.value="",i.value=""},k=()=>{o.value="",i.value=""},D=s=>new Date(s).toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});return(s,t)=>(a(),n(E,null,[C(z),o.value||i.value?(a(),V(F,{key:0,error:o.value,success:i.value,onClose:t[0]||(t[0]=W=>k()),class:"mx-auto"},null,8,["error","success"])):c("",!0),t[8]||(t[8]=e("div",{class:"py-6 px-0 text-center"},[e("h1",{class:"font-bold mb-2 mx-auto"},"Verify Signed Document"),e("h4",{class:"text-gray-800 max-w-160 mx-auto"}," Upload a ZIP file containing the signed document and signature file ")],-1)),e("div",N,[e("div",j,[e("div",{ref_key:"uploadArea",ref:y,class:I(["flex flex-col justify-around items-center min-h-[40vh] w-full relative bg-gradient-to-br from-gray-100 to-gray-50 rounded-2xl border-2 border-dashed border-gray-300 hover:border-blue-200 hover:bg-gradient-to-br hover:from-blue-50 hover:to-gray-50 transition-all duration-300 shadow-lg hover:shadow-xl",{"animate-pulse scale-[1.02] border-blue-500":f.value}]),onDragover:t[1]||(t[1]=m(()=>{},["prevent"])),onDragenter:t[2]||(t[2]=m(()=>{},["prevent"])),onDrop:m(b,["prevent"])},[u.value?(a(),n("div",B,t[3]||(t[3]=[e("div",{class:"text-center space-y-4 p-8"},[e("div",{class:"w-12 h-12 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mx-auto"}),e("p",{class:"font-semibold text-gray-700 text-lg"},"Verifying signature...")],-1)]))):c("",!0),l.value?c("",!0):(a(),n("i",L)),l.value?c("",!0):(a(),n("div",P,t[4]||(t[4]=[e("span",{class:"text-blue-600"},"Drag & Drop ZIP file",-1),e("br",null,null,-1),e("span",{class:"text-gray-400 text-lg"},"OR",-1),e("br",null,null,-1)]))),e("input",{type:"file",ref_key:"fileInput",ref:g,class:"hidden",accept:".zip",onChange:b},null,544),e("div",A,[l.value?(a(),n("button",{key:1,class:"bg-white hover:bg-gray-100 text-gray-700 py-3 px-8 rounded-xl text-lg font-semibold border-2 border-gray-400 hover:border-gray-300 shadow-md hover:shadow-lg transition-all duration-200 cursor-pointer",onClick:_}," CANCEL ")):(a(),n("button",{key:0,class:"bg-white hover:bg-gray-10 text-gray-700 py-3 px-8 rounded-xl text-lg font-semibold border-2 border-gray-300 shadow-md hover:shadow-lg transition-all duration-200 cursor-pointer",onClick:h}," SELECT FILE "))])],34)]),e("div",T,[l.value?(a(),n("p",Z,v(l.value.name)+" selected",1)):c("",!0)]),e("div",$,[e("button",{onClick:w,disabled:!l.value||u.value,class:"bg-gradient-to-r absolute from-blue-500 to-blue-600 text-white hover:from-blue-700 hover:to-blue-800 w-50 text-2xl font-semibold py-6 rounded-full border-1 border-black shadow-xl hover:shadow-xl transform hover:scale-105 transition-all duration-300 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"},v(u.value?"Verifying...":"Verify Signature"),9,R)]),d.value?(a(),n("div",U,[e("div",G,[t[7]||(t[7]=e("div",{class:"flex items-center gap-3 mb-4"},[e("i",{class:"mdi mdi-check-circle text-green-600 text-3xl"}),e("h3",{class:"text-xl font-semibold"},"Verification succesful!")],-1)),e("div",M,[e("p",null,[t[5]||(t[5]=e("strong",null,"Signer:",-1)),p(" "+v(d.value.signer_username),1)]),e("p",null,[t[6]||(t[6]=e("strong",null,"Signed at:",-1)),p(" "+v(D(d.value.signed_at)),1)])])])])):c("",!0)])],64))}};export{J as default};
